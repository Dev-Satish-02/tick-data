<!DOCTYPE html>
<html>

<head>
    <title>Tick Data Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial@3.3.0/dist/chartjs-chart-financial.min.js"></script>
</head>

<body>
    <h2>Tick Aggregator Dashboard (OHLCV)</h2>

    <div style="margin-bottom: 1rem;">
        <button onclick="startPublisher()">Start Publisher</button>
        <button onclick="startAggregator()">Start Aggregator</button>
        <button onclick="terminateProcesses()">Terminate Processes</button>
        <button onclick="downloadCSV()">Download CSV</button>
    </div>

    <div style="display: flex; gap: 2rem;">
        <div>
            <h4>Publisher Output</h4>
            <div id="publisherLog" class="log-box"></div>
        </div>
        <div>
            <label>Symbol:
                <input id="symbol" type="text" value="BTCUSDT" />
            </label>
            <button onclick="loadData()">Refresh Chart</button>
            <canvas id="ohlcChart" width="600" height="300"></canvas>
        </div>
    </div>

    <h3>Aggregator Data Table</h3>
    <div class="table-box" id="dataTableBox">
        <table id="dataTable">
            <thead>
                <tr>
                    <th>Symbol</th>
                    <th>Minute</th>
                    <th>Open</th>
                    <th>High</th>
                    <th>Low</th>
                    <th>Close</th>
                    <th>Volume</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>

</html>